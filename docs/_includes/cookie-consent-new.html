<!-- Cookie consent css & js -->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>

<script>
    // Leo la cookie
    function getCookie(name) {
        var b = document.cookie.match('(^|[^;]+)\\s*' + name + '\\s*=\\s*([^;]+)');
        return b ? b.pop() : '';
    }

    // Activo Plausible
    function addAnalytics() {
        var script = document.createElement("script");
        script.src = "https://plausible.io/js/plausible.js";
        script.setAttribute('data-domain', 'luispa.com');
        document.head.appendChild(script);
    }

    window.addEventListener("load", function() {
        var cookieName = "cookieconsent_luispa_status"

        // Leo la cookie
        const cookieConsent = getCookie(cookieName);

        // Arranco analytics si hay consentimiento o no declinó
        if (cookieConsent === 'allow' || cookieConsent === '') {
            addAnalytics();
        }

        // Parametrizo el banner
        window.cookieconsent.initialise({
            "palette": {
                "popup": {
                    "background": "#edeff5",
                    "text": "#838391"
                },
                "button": {
                    "background": "#4b81e8"
                }
            },
            "theme": "classic",
            "type": "opt-out",
            "cookie": {
                "name": cookieName
            },
            "content": {
                "policy": "Política de Cookies",
                "message": "Este blog utiliza cookies para conseguir la mejor experiencia de navegación, ",
                "allow": "Permitir",
                "dismiss": "Permitir",
                "deny": "Declinar",
                "link": "más información",
                "href": "/privacidad"
            },
            // Reload the page on user choice to make sure cookie is set
            onStatusChange: function(status, chosenBefore) {
                location.reload();
            }
        })
    });
</script>