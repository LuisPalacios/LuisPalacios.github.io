---
title: "IT Operations Portal"
date: "2022-02-05"
categories: administración
tags: linux itop cmdb gestión
excerpt_separator: <!--more-->
---

![Logo iTop](/assets/img/posts/logo-itop.svg){: width="150px" style="float:left; padding-right:25px" } 

Para tener control y gestión sobre los activos IT, equipos y labs, he estado probando [iTop](https://www.combodo.com/itop-193). iTop significa Portal de Operaciones de TI. Es una completa herramienta ITIL de gestión de servicios basada en web, que incluye un CMDB totalmente personalizable, un sistema de asistencia técnica y una herramienta de gestión de documentos. Ofrece herramientas de importación masiva y servicios web para integrarse con tu TI. He montado un pequeño laboratorio para probarla. 

<br clear="left"/>
<!--more-->

----

### Instalación

- Preparo un equipo (máquina virtual) Linux con Ubuntu Server. Creo un disco y la VM partiendo de la imagen ISO de Ubuntu Server. Dedicaré 20GB de disco, 2 CPU's y 2Gb de RAM.
```console
luis@maclinux:~$ wget https://releases.ubuntu.com/20.04/ubuntu-20.04.3-live-server-amd64.iso
luis@maclinux:~$ qemu-img create -f qcow2 itop.tudominio.com.qcow2 20G
luis@maclinux:~$ virt-manager
```
- Desde `virt-manager` → Nueva máquina virtual, uso el ISO anterior y llamo al servidor `itop.tudominio.com` (el dominio es privado, con mi [DNS Server]({% post_url 2021-06-20-pihole-casero %})) basado en `pihole`.
  - Con la [documentación oficial](https://www.itophub.io/wiki/page?id=2_4_0%3Ainstall%3Ainstalling_itop) y [guía de instalación](https://www.itophub.io/wiki/page?id=2_4_0%3Agettingstarted) como referencia, empiezo la instalación por las dependencias: MySQL and PHP and Apache
```console
root@itop:~# apt update && apt upgrade -y
root@itop:~# apt install -y apache2
root@itop:~# apt install -y mysql-server mysql-client
root@itop:~# apt install -y php php-mysql php-ldap php-cli php-soap php-json graphviz
root@itop:~# apt install -y php-xml php-gd php-zip libapache2-mod-php php-mbstring php-curl
```
  - Adapto la configuración PHP en /etc/php/7.4/apache2/php.ini
```ini
max_input_time = 120
max_input_vars = 5000
post_max_size = 26M
upload_tmp_dir =/tmp
upload_max_filesize = 25M
```
  - Adapto la configuración MYSQL en /etc/mysql/conf.d/mysql.cnf
```ini
[mysql]
max_allowed_packet	= 30M
```
  - Adapto la configuración MYSQL en /etc/mysql/conf.d/mysqldump.cnf
```ini
[mysqldump]
:
max_allowed_packet	= 30M
```
  - Rearranco el equipo
```console
root@itop:~# systemctl reboot -f
```
  - Establezco la contraseña del usuario `root` en MySQL. 
```console
root@itop:~# mysql_secure_installation
```
  - Este MySQL solo lo voy a usar con iTop así que uso a root, le pongo una contraseña
```console
root@itop:~# mysql
mysql > ALTER USER 'root'@'localhost' IDENTIFIED WITH caching_sha2_password BY 'TuContraseña';
mysql> FLUSH PRIVILEGES;
mysql> exit
```
- Descargo la [última versión de iTop](https://sourceforge.net/projects/itop/files/) desde Sourceforge, en mi caso la 3.0.0 y la descomprimo en el directorio del web server. Este Apache solo va a servir para este propósito, así que lo dejo en la raiz.
```console
root@itop:~# cd /var/www/html/
root@itop:/var/www/html# rm index.html
root@itop:/var/www/html# unzip /home/luis/iTop-3.0.0-8663.zip
root@itop:/var/www/html# mv web/* .
root@itop:/var/www/html# rmdir web
root@itop:/var/www/html# chown -R www-data .
```
- Conecto con iTop, que arranca el asistente de configuración
  - http://itop.tudominio.com

{% include showImagen.html 
      src="/assets/img/posts/2022-02-05-itop-1.png" 
      caption="Inicio el asistente"
      width="600px"
      %}

- Sigo los pasos de instalación: 
  - Install a new iTop
  - Server connection: root, <TuContraseña>
  - Create new database: itop
  - Administrator account: admin, <Ponerle contraseña>
  - Lo dejo en English, la traducción tiene algunas cosillas..
  - Empiezo por una BD vacía
  - Dejo todas las opciones de tipos de elemnto a ser gestionados.
  - Service Management for Enterprises
  - Indico que no voy a hacer gestión de Tickets. 
  - Indico que no voy a hacer gestión de cambios.

- A partir de aquí queda instalada y accesible en http://itop.tudominio.com en mi intranet.

----

<br/>
